
namespace Api.Funcionalidades{
public class DomicilioService
{
    private readonly DbContext _context;

    public DomicilioService(DbContext context)
    {
        _context = context;
    }

    public async Task<DomicilioQueryDto> CreateDomicilioAsync(DomicilioCommandDto domicilioDto)
    {
        var domicilio = new Domicilio
        {
            Id = domicilioDto.Id,
            Pais = domicilioDto.Pais,
            Ciudad = domicilioDto.Ciudad,
            Calle = domicilioDto.Calle,
            Numero = domicilioDto.Numero,
            CodigoPostal = domicilioDto.CodigoPostal
        };

        _context.Domicilios.Add(domicilio);
        await _context.SaveChangesAsync();

        return new DomicilioQueryDto
        {
            Id = domicilio.Id,
            Pais = domicilio.Pais,
            Ciudad = domicilio.Ciudad,
            Calle = domicilio.Calle,
            Numero = domicilio.Numero,
            CodigoPostal = domicilio.CodigoPostal
        };
    }

    public async Task<DomicilioQueryDto> UpdateDomicilioAsync(Guid id, DomicilioCommandDto domicilioDto)
    {
        var domicilio = await _context.Domicilios.FindAsync(id);
        if (domicilio == null) return null;

        domicilio.Pais = domicilioDto.Pais;
        domicilio.Ciudad = domicilioDto.Ciudad;
        domicilio.Calle = domicilioDto.Calle;
        domicilio.Numero = domicilioDto.Numero;
        domicilio.CodigoPostal = domicilioDto.CodigoPostal;

        await _context.SaveChangesAsync();

        return new DomicilioQueryDto
        {
            Id = domicilio.Id,
            Pais = domicilio.Pais,
            Ciudad = domicilio.Ciudad,
            Calle = domicilio.Calle,
            Numero = domicilio.Numero,
            CodigoPostal = domicilio.CodigoPostal
        };
    }

    public async Task<bool> DeleteDomicilioAsync(Guid id)
    {
        var domicilio = await _context.Domicilios.FindAsync(id);
        if (domicilio == null) return false;

        _context.Domicilios.Remove(domicilio);
        await _context.SaveChangesAsync();

        return true;
    }
}
}